<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Sheet H·ªçc T·∫≠p - Xu√¢n B√≠nh Ng·ªç 2026</title>
  <meta name="description" content="Sheet h·ªçc t·∫≠p,kh√≥a xps 2k8 n∆°i h·ªçc t·∫≠p ch√≠nh c·ªßa h·ªçc vi√™n h·ªá th·ªëng khoahocvip.io.vn. Ch√∫c m·ª´ng nƒÉm m·ªõi Xu√¢n B√≠nh Ng·ªç!">
  <link rel="icon" href="iogo.png" type="image/png">
  
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://khoahocvip.io.vn/sheet">
  <meta property="og:title" content="Sheet H·ªçc T·∫≠p - Khoahocvip.io.vn">
  <meta property="og:description" content="Full combo luy·ªán thi THPT XPS 2K8, IELTS, TOEIC... ƒê√≥n T·∫øt B√≠nh Ng·ªç r·ª±c r·ª°!">
  <meta property="og:image" content="iogo.png">
  
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700;900&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">

  <style>
    :root { 
      --nav-h: 58px;
      --tet-red: #D70018;
      --tet-dark-red: #98000E;
      --tet-gold: #FFD700;
    }
    
    html, body { height: 100%; margin: 0; padding: 0; overflow: hidden; }
    
    /* Background & Font */
    body { 
      font-family: 'Be Vietnam Pro', sans-serif; 
      padding-top: var(--nav-h); 
      box-sizing: border-box;
      background: linear-gradient(135deg, var(--tet-dark-red) 20%, var(--tet-red) 100%);
      background-image: url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M20 20.5V18H0v-2h20v-2H0v-2h20v-2H0V8h20V6H0V4h20V2H0V0h22v20h2V0h2v20h2V0h2v20h2V0h2v20h2V0h2v20h2v2H20v-1.5zM0 20h2v20H0V20zm4 0h2v20H4V20zm4 0h2v20H8V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20z' fill='%23ffd700' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
    }

    /* === Hi·ªáu ·ª©ng Hoa R∆°i === */
    #falling-container {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none;
      z-index: 45; 
      overflow: hidden;
    }
    .petal {
      position: absolute; top: -10%;
      text-shadow: 0 0 5px rgba(255,255,255,0.3);
      animation: fall linear infinite;
    }
    @keyframes fall {
      0% { transform: translateY(0) rotate(0deg) translateX(0); opacity: 0.9; }
      50% { transform: translateY(55vh) rotate(180deg) translateX(20px); opacity: 0.7; }
      100% { transform: translateY(110vh) rotate(360deg) translateX(-20px); opacity: 0; }
    }

    /* === M√†n h√¨nh ch·ªù Full-screen T·∫øt === */
    #tet-loading-overlay {
      position: fixed; inset: 0; z-index: 200; 
      background: linear-gradient(to bottom, var(--tet-dark-red), var(--tet-red));
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      transition: opacity 0.8s ease-out, visibility 0.8s;
      padding: 20px; /* Th√™m padding ƒë·ªÉ tr√°nh s√°t l·ªÅ tr√™n mobile */
    }
    #tet-loading-overlay.loaded {
      opacity: 0; visibility: hidden; pointer-events: none;
    }
    .loading-content { 
      text-align: center; color: var(--tet-gold); width: 100%; max-width: 500px;
    }
    .big-lantern { 
      /* K√≠ch th∆∞·ªõc ch·ªØ s·∫Ω ch·ªânh b·∫±ng Tailwind ·ªü d∆∞·ªõi cho responsive */
      filter: drop-shadow(0 0 25px rgba(255, 215, 0, 0.6));
      animation: swing-big 3s infinite ease-in-out;
      display: block; margin: 0 auto;
    }
    @keyframes swing-big { 0%, 100% { transform: rotate(-5deg) translateY(0); } 50% { transform: rotate(5deg) translateY(-10px); } }

    /* Main Content Wrap */
    #main-content { 
      display: flex; flex-direction: column; height: 100%; gap: .5rem; 
      position: relative; z-index: 10;
    }
    #sheet-wrap {
      position: relative; flex: 1 1 auto; min-height: 0; overflow: hidden;
      border-radius: 16px; 
      background: #fff;
      box-shadow: 0 0 0 3px var(--tet-dark-red), 0 0 0 6px var(--tet-gold), 0 10px 30px rgba(0,0,0,0.5);
    }
    /* Th√™m will-change ƒë·ªÉ b√°o tr√¨nh duy·ªát t·ªëi ∆∞u render */
    #sheet-iframe { 
      width: 100%; height: 100%; border: 0; 
      transform-origin: top left; 
      will-change: transform, width, height; 
    }

    /* Navbar T·∫øt */
    .nav-tet {
      background: rgba(152, 0, 14, 0.92);
      backdrop-filter: blur(12px);
      border-bottom: 2px solid rgba(255, 215, 0, 0.5);
      box-shadow: 0 4px 20px rgba(0,0,0,0.4);
    }

    /* N√∫t L√¨ X√¨ */
    .btn-lixi {
      background: linear-gradient(to right bottom, #FFD700, #FFA500);
      color: #98000E; font-weight: 800;
      border: 2px solid #FFF;
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
      position: relative; overflow: hidden;
    }
    .btn-lixi::before {
      content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
      background: linear-gradient(120deg, transparent, rgba(255,255,255, 0.6), transparent);
      animation: shine 3s infinite linear;
    }
    @keyframes shine { to { left: 100%; } }

    /* N√∫t Zoom */
    .zoom-btn-tet { background: rgba(255,255,255,0.1); color: var(--tet-gold); border: 1px solid rgba(255,215,0,0.3); }
    .zoom-btn-tet:hover { background: rgba(255,215,0,0.2); border-color: var(--tet-gold); }
    .zoom-btn-main { background: var(--tet-red); color: var(--tet-gold); border: 1px solid var(--tet-gold); box-shadow: 0 0 5px var(--tet-gold); }

    .zoom-bubble {
      position: absolute; top: 120%; right: 0; 
      background: #FFF; color: var(--tet-dark-red); border: 2px solid var(--tet-gold);
      padding: 6px 12px; border-radius: 8px; font-weight: 700; font-size: 13px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3); z-index: 60; white-space: nowrap;
    }
    .zoom-bubble::after {
      content: ""; position: absolute; top: -7px; right: 15px; width: 12px; height: 12px;
      background: #FFF; border-top: 2px solid var(--tet-gold); border-left: 2px solid var(--tet-gold);
      transform: rotate(45deg);
    }

    .font-thuphap { font-family: 'Dancing Script', cursive; }
    html, body { touch-action: pan-x pan-y; }

    /* Mobile Responsive */
    @media (max-width: 768px){
      :root { --nav-h: 54px; }
      #sheet-iframe { transform: scale(.45); width: 222.22%; height: 222.22%; }
      .zoom-btn-tet, .zoom-btn-main { padding: 5px 10px !important; font-size: 14px !important; }
      .btn-lixi { padding: 6px 10px !important; font-size: 13px !important; gap: 4px; }
      
      /* C√¢n ch·ªânh l·∫°i loading screen tr√™n mobile */
      .loading-content { width: 90%; }
    }
  </style>
</head>
<body class="selection:bg-yellow-300 selection:text-red-900">

  <div id="falling-container"></div>

  <div id="tet-loading-overlay">
    <div class="loading-content flex flex-col items-center">
        <div class="big-lantern text-6xl md:text-8xl mb-4">üèÆ</div>
        
        <h1 class="font-thuphap text-3xl sm:text-4xl md:text-6xl text-yellow-300 mb-3 drop-shadow-lg leading-tight px-2">
            Xu√¢n B√≠nh Ng·ªç 2026
        </h1>
        
        <p class="text-yellow-100 text-sm sm:text-base md:text-xl font-medium px-4 opacity-90">
            KHOAHOCVIP k√≠nh ch√∫c nƒÉm m·ªõi<br class="block sm:hidden"> V·∫°n s·ª± nh∆∞ √Ω!
        </p>
        
        <div class="mt-8 flex items-center gap-3 text-yellow-200/80 text-sm sm:text-base">
            <svg class="animate-spin h-5 w-5 sm:h-6 sm:w-6 text-yellow-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <span>ƒêang t·∫£i d·ªØ li·ªáu...</span>
        </div>
    </div>
  </div>

  <nav class="fixed top-0 left-0 right-0 z-50 nav-tet" style="height:var(--nav-h);">
    <div class="mx-auto max-w-7xl h-full px-4 sm:px-6 lg:px-8">
      <div class="h-full flex items-center justify-between">
        <a class="flex items-center gap-2 group" href="/" title="Trang ch·ªß">
          <img class="h-9 w-auto drop-shadow-[0_2px_4px_rgba(255,215,0,0.5)] group-hover:rotate-12 transition duration-300" src="iogo.png" alt="Khoahocvip">
          <div class="hidden sm:flex flex-col">
             <span class="text-base font-black text-yellow-400 tracking-wider drop-shadow-sm leading-tight">KHOAHOCVIP</span>
             <span class="text-[11px] text-yellow-200/80 font-thuphap leading-tight">Cung ch√∫c t√¢n xu√¢n B√≠nh Ng·ªç 2026 </span>
          </div>
        </a>

        <div class="flex items-center gap-2 md:gap-4">
          <div id="zoom-group" class="relative flex items-center gap-1.5">
            <button id="zoom-out" class="zoom-btn-tet px-3 py-1.5 rounded-lg active:scale-95 transition" aria-label="Thu nh·ªè">
              <span class="font-bold text-lg leading-none">‚àí</span>
            </button>
            <button id="zoom-in"  class="zoom-btn-main px-3 py-1.5 rounded-lg shadow active:scale-95 transition" aria-label="Ph√≥ng to">
              <span class="font-bold text-lg leading-none">+</span>
            </button>
            <button id="zoom-reset" class="zoom-btn-tet px-3 py-1.5 rounded-lg active:scale-95 transition text-xs font-bold tracking-wider" aria-label="M·∫∑c ƒë·ªãnh">
              RESET
            </button>
            <div id="zoom-hint" class="zoom-bubble hidden">
              <span class="text-red-600 mr-1">‚òÖ</span> Ph√≥ng to / Thu nh·ªè
            </div>
          </div>

          <a href="https://zalo.me/0327359035"
             class="btn-lixi inline-flex items-center gap-2 rounded-xl py-2 px-4 shadow-lg hover:scale-105 active:scale-95 transition">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 shrink-0" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M5 5a3 3 0 015-2.236A3 3 0 0114.83 6H16a2 2 0 110 4h-5V9a1 1 0 10-2 0v1H4a2 2 0 110-4h1.17C5.06 5.687 5 5.35 5 5zm4 1V5a1 1 0 10-1 1h1zm3 0a1 1 0 10-1-1v1h1z" clip-rule="evenodd" />
                <path d="M9 11H3v5a2 2 0 002 2h4v-7zM11 18h4a2 2 0 002-2v-5h-6v7z" />
            </svg>
            <span class="hidden sm:inline uppercase text-sm">Mua Kh√≥a H·ªçc - Nh·∫≠n L√¨ X√¨</span>
            <span class="sm:hidden text-xs uppercase">Mua</span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  <main id="main-content" class="px-2 sm:px-6 pb-3 pt-2">
    <div id="sheet-wrap">
      <iframe id="sheet-iframe"
        src="https://docs.google.com/spreadsheets/d/1kwcF_6vDUL80fyvpmSMFedubfFJs5bIum5SvTHmf86Q/edit?usp=sharing"
        allowfullscreen
        title="Sheet H·ªçc T·∫≠p - Khoahocvip.io.vn">
      </iframe>
    </div>
  </main>

  <div id="popup-overlay" class="fixed inset-0 bg-black/80 flex items-center justify-center z-[100] p-4 hidden backdrop-blur-sm">
    <div id="popup-content" class="relative group">
      <div class="absolute -inset-2 bg-gradient-to-r from-red-600 via-yellow-500 to-red-600 rounded-2xl blur-md opacity-75 group-hover:opacity-100 transition duration-1000 animate-pulse"></div>
      <div class="relative">
        <img src="thongbao1.png" alt="Th√¥ng b√°o" class="block max-h-[85vh] w-auto rounded-xl shadow-2xl border-2 border-yellow-400/50">
        <button id="close-popup" class="absolute -top-4 -right-4 w-11 h-11 bg-gradient-to-br from-yellow-300 to-yellow-500 border-2 border-red-700 rounded-full flex items-center justify-center text-red-900 hover:scale-110 transition-all shadow-xl font-bold text-xl">
          ‚úï
        </button>
      </div>
    </div>
  </div>

  <script>
    // ========= Hi·ªáu ·ª©ng Hoa R∆°i =========
    function createFallingPetals() {
      const container = document.getElementById('falling-container');
      const symbols = ['üå∏', 'üåº', 'üå∏', 'üåº', 'üßß', 'üí∞', '‚ú®', 'üèÆ']; 
      const particleCount = 35; 

      for (let i = 0; i < particleCount; i++) {
        const el = document.createElement('div');
        el.classList.add('petal');
        el.innerText = symbols[Math.floor(Math.random() * symbols.length)];
        el.style.left = Math.random() * 100 + 'vw';
        el.style.fontSize = (Math.random() * 20 + 12) + 'px'; 
        el.style.animationDuration = (Math.random() * 8 + 6) + 's'; 
        el.style.animationDelay = (Math.random() * 8) + 's';
        container.appendChild(el);
      }
    }
    createFallingPetals();

    // ========= Logic Loading & Zoom =========
    const iframe = document.getElementById('sheet-iframe');
    const loadingOverlay = document.getElementById('tet-loading-overlay');
    const hint = document.getElementById('zoom-hint');

    iframe.addEventListener('load', () => {
      setTimeout(() => {
          loadingOverlay.classList.add('loaded');
          setTimeout(() => loadingOverlay.remove(), 850);
      }, 800);
    });

    // === QUAN TR·ªåNG: S·ª¨A L·ªñI CRASH TR√äN MOBILE ===
    let zoomLevel = Number(localStorage.getItem('sheetZoom') || '1');
    
    function applyZoom() {
      iframe.style.transform = `scale(${zoomLevel})`;
      iframe.style.width = (100 / zoomLevel) + '%';
      iframe.style.height = (100 / zoomLevel) + '%';
      localStorage.setItem('sheetZoom', String(zoomLevel));
    }

    // Gi·ªõi h·∫°n zoom t·ªëi thi·ªÉu l√† 0.5 (50%) thay v√¨ 0.2
    // N·∫øu xu·ªëng d∆∞·ªõi 0.5, k√≠ch th∆∞·ªõc iframe s·∫Ω qu√° l·ªõn (>20000px) g√¢y tr√†n b·ªô nh·ªõ RAM ƒëi·ªán tho·∫°i
    function clampZoom(z){ 
        return Math.min(2.0, Math.max(0.5, Math.round(z*10)/10)); 
    }

    document.getElementById('zoom-in').onclick  = () => { zoomLevel = clampZoom(zoomLevel + 0.1); applyZoom(); };
    document.getElementById('zoom-out').onclick = () => { zoomLevel = clampZoom(zoomLevel - 0.1); applyZoom(); };
    document.getElementById('zoom-reset').onclick = () => { zoomLevel = 0.8; applyZoom(); };

    window.addEventListener('keydown', (e)=>{
      if (['INPUT','TEXTAREA'].includes((e.target.tagName||'').toUpperCase())) return;
      if (e.key === '+'){ e.preventDefault(); zoomLevel = clampZoom(zoomLevel + 0.1); applyZoom(); }
      if (e.key === '-'){ e.preventDefault(); zoomLevel = clampZoom(zoomLevel - 0.1); applyZoom(); }
      if (e.key === '0'){ e.preventDefault(); zoomLevel = 1; applyZoom(); }
    });
    applyZoom();

    // Zoom Hint Bubble
    let shownCount = 0;
    function showHintOnce(){
      if (shownCount >= 2) return;
      hint.classList.remove('hidden');
      setTimeout(()=>{
        hint.classList.add('hidden');
        shownCount++;
        if (shownCount < 2) setTimeout(showHintOnce, 6000);
      }, 4000);
    }
    window.addEventListener('load', ()=> setTimeout(showHintOnce, 2500));
  </script>

  <script>
    // Ch·∫∑n gesture Safari
    window.addEventListener('gesturestart',  e => e.preventDefault(), {passive:false});
    window.addEventListener('gesturechange', e => e.preventDefault(), {passive:false});
    window.addEventListener('gestureend',    e => e.preventDefault(), {passive:false});
    document.addEventListener('touchmove', (e) => {
      if (e.touches && e.touches.length > 1) e.preventDefault();
    }, {passive:false});
  </script>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const popupOverlay = document.getElementById('popup-overlay');
      const closePopupButton = document.getElementById('close-popup');

      function closePopup() {
        if (popupOverlay) {
          popupOverlay.classList.add('hidden');
          popupOverlay.classList.remove('flex');
          document.body.style.overflow = '';
        }
      }
      
      // setTimeout(() => { if(popupOverlay) { popupOverlay.classList.remove('hidden'); popupOverlay.classList.add('flex'); document.body.style.overflow = 'hidden'; } }, 3000);

      if (closePopupButton) closePopupButton.addEventListener('click', closePopup);
      if (popupOverlay) {
        popupOverlay.addEventListener('click', (event) => {
          if (event.target === popupOverlay) closePopup();
        });
      }
    });
  </script>

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-T3HC34BE89"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-T3HC34BE89');
  </script>
</body>
</html>
<!-- <!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Sheet H·ªçc T·∫≠p - Khoahocvip.io.vn</title>
  <meta name="description" content="Sheet h·ªçc t·∫≠p,kh√≥a xps 2k8 n∆°i h·ªçc t·∫≠p ch√≠nh c·ªßa h·ªçc vi√™n h·ªá th·ªëng khoahocvip.io.vn. Xem t√™n nh·ªØng th·∫ßy c√¥ b·∫°n ƒë∆∞·ª£c h·ªçc.">
  <link rel="icon" href="iogo.png" type="image/png">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://khoahocvip.io.vn/sheet">
  <meta property="og:title" content="Sheet H·ªçc T·∫≠p - Khoahocvip.io.vn">
  <meta property="og:description" content="Full combo luy·ªán thi THPT XPS 2K8, IELTS, TOEIC, ƒê·∫†I H·ªåC v√† nhi·ªÅu k·ªπ nƒÉng kh√°c. ƒêƒÉng k√Ω m·ªôt l·∫ßn, h·ªçc tr·ªçn ƒë·ªùi!">
  <meta property="og:image" content="iogo.png">
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://khoahocvip.io.vn/sheet">
  <meta property="twitter:title" content="KHO KH√ìA H·ªåC CHUI DRIVE">
  <meta property="twitter:description" content="Full combo luy·ªán thi THPT XPS 2K8, IELTS, TOEIC, ƒê·∫†I H·ªåC v√† nhi·ªÅu k·ªπ nƒÉng kh√°c. ƒêƒÉng k√Ω m·ªôt l·∫ßn, h·ªçc tr·ªçn ƒë·ªùi!">
  <meta property="twitter:image" content="iogo.png">

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700;900&display=swap" rel="stylesheet">

  <style>
    :root{ --nav-h: 48px; } /* thanh top m·ªèng h∆°n */
    html, body{ height:100%; margin:0; padding:0; overflow:hidden; background:#f5f7fb;}
    body{ font-family:'Be Vietnam Pro',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; padding-top:var(--nav-h); box-sizing:border-box; }

    /* khung ch√≠nh */
    #main-content{ display:flex; flex-direction:column; height:100%; gap:.75rem; }
    #sheet-wrap{
      position:relative; flex:1 1 auto; min-height:0; overflow:hidden;
      border-radius:14px; background:#fff;
      border:1px solid #e8ebf0;
      box-shadow:0 10px 20px -12px rgba(0,0,0,.15), 0 4px 8px -8px rgba(0,0,0,.08);
    }
    #sheet-iframe{ width:100%; height:100%; border:0; transform-origin: top left; }

    /* overlay loading */
    #loading{
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
      background:linear-gradient(180deg, rgba(248,250,253,.9), rgba(248,250,253,.6));
      backdrop-filter:saturate(120%) blur(2px);
      z-index:40;
    }
    .spinner{
      width:34px; height:34px; border-radius:999px; border:3px solid #dbe3f0; border-top-color:#2563eb;
      animation:spin .8s linear infinite;
    }
    html, body {
    /* Cho ph√©p k√©o ngang/d·ªçc, KH√îNG cho pinch-zoom */
      touch-action: pan-x pan-y;
    }

    @keyframes spin{ to{ transform:rotate(360deg);} }

    /* nav b√≥ng nh·∫π */
    .nav-shadow{ box-shadow:0 6px 18px -12px rgba(0,0,0,.25), 0 2px 6px -4px rgba(0,0,0,.08); }

    /* Bong b√≥ng zoom n·∫±m d∆∞·ªõi c·ª•m n√∫t */
    .zoom-bubble{
      position:absolute; top:110%; right:0; background:rgba(17,24,39,.92); color:#fff;
      padding:6px 10px; border-radius:10px; font-size:13px; line-height:1;
      box-shadow:0 10px 24px rgba(0,0,0,.25); z-index:60; white-space:nowrap;
    }
    .zoom-bubble::after{
      content:""; position:absolute; top:-6px; right:14px; width:12px; height:12px;
      background:rgba(17,24,39,.92); transform:rotate(45deg);
    }

    /* Mobile t·ªëi ∆∞u */
    @media (max-width: 768px){
      :root{ --nav-h: 46px; }
      #sheet-iframe{ transform:scale(.45); width:222.22%; height:222.22%; }
      .zoom-btn{ padding:4px 9px !important; font-size:12px !important; }
      .buy-btn{ padding:6px 10px !important; font-size:13px !important; }
    }
  </style>
</head>
<body class="text-gray-800 selection:bg-blue-600/10 selection:text-blue-800">

  <nav class="bg-white/90 backdrop-blur-md fixed top-0 left-0 right-0 z-50 nav-shadow" style="height:var(--nav-h);">
    <div class="mx-auto max-w-6xl h-full px-3 sm:px-5">
      <div class="h-full flex items-center justify-between">
        <a class="flex items-center gap-2" href="/" title="Trang ch·ªß">
          <img class="h-8 w-auto" src="iogo.png" alt="Khoahocvip">
          <span class="hidden sm:block text-sm font-semibold text-gray-700">KHOAHOCVIP</span>
        </a>

        <div class="flex items-center gap-2 md:gap-3">
          <div id="zoom-group" class="relative flex items-center gap-1">
            <button id="zoom-out" class="zoom-btn px-3 py-1.5 rounded-lg bg-blue border border-gray-200 shadow-sm hover:border-gray-300 hover:bg-gray-50 active:scale-[.98] transition text-gray-700" aria-label="Thu nh·ªè (‚àí)">‚àí</button>
            <button id="zoom-in"  class="zoom-btn px-3 py-1.5 rounded-lg bg-blue-600 text-white shadow hover:bg-blue-700 active:scale-[.98] transition" aria-label="Ph√≥ng to (+)">+</button>
            <button id="zoom-reset" class="zoom-btn px-3 py-1.5 rounded-lg bg-gray-700 text-white shadow hover:bg-gray-800 active:scale-[.98] transition" aria-label="V·ªÅ 100%">Reset</button>
            <div id="zoom-hint" class="zoom-bubble hidden">THU NH·ªé - PH√ìNG TO ·ªû ƒê√ÇY !</div>
          </div>

          <a href="https://zalo.me/0327359035"
             class="buy-btn inline-flex items-center gap-2 rounded-xl bg-blue-600 text-white font-semibold py-2 px-3 md:px-4 shadow hover:shadow-md hover:bg-blue-700 active:scale-[.98] transition">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.8">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <span class="hidden sm:inline">Mua kh√≥a h·ªçc</span><span class="sm:hidden">Mua</span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  <main id="main-content" class="px-3 sm:px-5 pb-3 pt-0">
    <div id="sheet-wrap">
      <div id="loading">
        <div class="flex flex-col items-center gap-3 text-gray-600">
          <div class="spinner"></div>
          <p class="text-sm">ƒêang t·∫£i trang t√≠nh‚Ä¶</p>
        </div>
      </div>

      <iframe id="sheet-iframe"
        src="https://docs.google.com/spreadsheets/d/1kwcF_6vDUL80fyvpmSMFedubfFJs5bIum5SvTHmf86Q/edit?usp=sharing"
        allowfullscreen
        title="Sheet H·ªçc T·∫≠p - Khoahocvip.io.vn">
        ƒêang t·∫£i trang t√≠nh c·ªßa b·∫°n...
      </iframe>
    </div>
  </main>

  <div id="popup-overlay" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-[100] p-4" style="display: none; backdrop-filter: blur(4px);">
    <div id="popup-content" class="relative">
      <img src="thongbao1.png" alt="Th√¥ng b√°o" class="block max-h-[85vh] w-auto rounded-lg shadow-2xl">
      <button id="close-popup" class="absolute -top-3 -right-3 w-9 h-9 bg-white rounded-full flex items-center justify-center text-gray-800 hover:bg-gray-200 hover:scale-110 transition-all shadow-lg" aria-label="ƒê√≥ng th√¥ng b√°o">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
  </div>


  <script>
    // ========= Helpers =========
    const iframe = document.getElementById('sheet-iframe');
    const loading = document.getElementById('loading');
    const hint = document.getElementById('zoom-hint');

    // ·∫®n overlay khi iframe load
    iframe.addEventListener('load', () => {
      loading.style.display = 'none';
    });

    // ========= Zoom =========
    let zoomLevel = Number(localStorage.getItem('sheetZoom') || '1');
    function applyZoom() {
      iframe.style.transform = `scale(${zoomLevel})`;
      iframe.style.width = (100 / zoomLevel) + '%';
      iframe.style.height = (100 / zoomLevel) + '%';
      localStorage.setItem('sheetZoom', String(zoomLevel));
    }
    function clampZoom(z){ return Math.min(2.0, Math.max(0.2, Math.round(z*10)/10)); }

    document.getElementById('zoom-in').onclick  = () => { zoomLevel = clampZoom(zoomLevel + 0.1); applyZoom(); };
    document.getElementById('zoom-out').onclick = () => { zoomLevel = clampZoom(zoomLevel - 0.1); applyZoom(); };
    document.getElementById('zoom-reset').onclick = () => { zoomLevel = 0.8; applyZoom(); };

    // Ph√≠m t·∫Øt: + / - / 0
    window.addEventListener('keydown', (e)=>{
      if (['INPUT','TEXTAREA'].includes((e.target.tagName||'').toUpperCase())) return;
      if (e.key === '+'){ e.preventDefault(); zoomLevel = clampZoom(zoomLevel + 0.1); applyZoom(); }
      if (e.key === '-'){ e.preventDefault(); zoomLevel = clampZoom(zoomLevel - 0.1); applyZoom(); }
      if (e.key === '0'){ e.preventDefault(); zoomLevel = 1; applyZoom(); }
    });

    // √Åp d·ª•ng zoom ban ƒë·∫ßu
    applyZoom();

    // ========= Bong b√≥ng Zoom: 3 l·∫ßn (5s b·∫≠t / 5s t·∫Øt) =========
    let shownCount = 0;
    function showHintOnce(){
      if (shownCount >= 3) return;
      hint.classList.remove('hidden');
      setTimeout(()=>{
        hint.classList.add('hidden');
        shownCount++;
        if (shownCount < 3) setTimeout(showHintOnce, 5000);
      }, 5000);
    }
    window.addEventListener('load', ()=> setTimeout(showHintOnce, 350));
  </script>
  <script>
    // Ch·∫∑n gesture c·ªßa Safari iOS (non-standard nh∆∞ng c·∫ßn thi·∫øt)
    window.addEventListener('gesturestart',  e => e.preventDefault(), {passive:false});
    window.addEventListener('gesturechange', e => e.preventDefault(), {passive:false});
    window.addEventListener('gestureend',    e => e.preventDefault(), {passive:false});
  
    // Ph√≤ng tr∆∞·ªùng h·ª£p m·ªôt s·ªë tr√¨nh duy·ªát v·∫´n c·ªë pinch -> ch·∫∑n khi c√≥ 2 ng√≥n
    document.addEventListener('touchmove', (e) => {
      if (e.touches && e.touches.length > 1) e.preventDefault();
    }, {passive:false});
  </script>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const popupOverlay = document.getElementById('popup-overlay');
      const closePopupButton = document.getElementById('close-popup');

      function openPopup() {
        if (popupOverlay) {
          popupOverlay.style.display = 'flex';
          // Ch·∫∑n cu·ªôn trang n·ªÅn khi popup ƒëang m·ªü
          document.body.style.overflow = 'hidden'; 
        }
      }

      function closePopup() {
        if (popupOverlay) {
          popupOverlay.style.display = 'none';
          // Cho ph√©p cu·ªôn trang n·ªÅn l·∫°i
          document.body.style.overflow = 'hidden'; // V·∫´n gi·ªØ hidden v√¨ body g·ªëc ƒë√£ l√† hidden
        }
      }

      // CMT ƒê·ªÇ T·∫ÆT HO·∫∂C M·ªû TH√îNG B√ÅO ·ªû ƒê√ÇY CMT ƒê·ªÇ T·∫ÆT HO·∫∂C M·ªû TH√îNG B√ÅO ·ªû ƒê√ÇY CMT ƒê·ªÇ T·∫ÆT HO·∫∂C M·ªû TH√îNG B√ÅO ·ªû ƒê√ÇY CMT ƒê·ªÇ T·∫ÆT HO·∫∂C M·ªû TH√îNG B√ÅO ·ªû ƒê√ÇY CMT ƒê·ªÇ T·∫ÆT HO·∫∂C M·ªû TH√îNG B√ÅO ·ªû ƒê√ÇY CMT ƒê·ªÇ T·∫ÆT HO·∫∂C M·ªû TH√îNG B√ÅO ·ªû ƒê√ÇY
      // setTimeout(openPopup, 1000);

      // ƒê√≥ng popup khi nh·∫•n n√∫t X
      if (closePopupButton) {
        closePopupButton.addEventListener('click', closePopup);
      }

      // ƒê√≥ng popup khi nh·∫•n v√†o v√πng n·ªÅn m·ªù
      if (popupOverlay) {
        popupOverlay.addEventListener('click', (event) => {
          // Ch·ªâ ƒë√≥ng khi click v√†o ch√≠nh overlay, kh√¥ng ph·∫£i ·∫£nh hay n√∫t
          if (event.target === popupOverlay) {
            closePopup();
          }
        });
      }
    });
  </script>

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-T3HC34BE89"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-T3HC34BE89');
  </script>
</body>
</html> -->
