<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>H√≥a ƒê∆°n Vu√¥ng - T·∫øt 2026</title>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Be+Vietnam+Pro:wght@400;600;800&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">

  <style>
    :root {
      --red-primary: #b91c1c; /* ƒê·ªè ƒë√¥ */
      --red-light: #ef4444;   /* ƒê·ªè t∆∞∆°i */
      --gold: #FCD34D;        /* V√†ng kim */
      --cream: #FFFBEB;       /* M√†u kem */
    }

    body {
      background-color: #f3f4f6;
      font-family: 'Be Vietnam Pro', sans-serif;
      padding: 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* Khung nh·∫≠p li·ªáu */
    .input-panel {
      background: white;
      width: 100%;
      max-width: 800px;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      margin-bottom: 2rem;
    }

    h2 { color: var(--red-primary); text-align: center; margin-bottom: 1.5rem; text-transform: uppercase; }

    .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
    
    label { font-weight: 600; font-size: 0.9rem; color: #4b5563; margin-bottom: 4px; display: block; }
    input { width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 0.95rem; }
    input:focus { border-color: var(--red-primary); outline: none; box-shadow: 0 0 0 3px rgba(185, 28, 28, 0.1); }

    .btn {
      background: linear-gradient(to right, var(--red-primary), var(--red-light));
      color: white; border: none; padding: 12px 24px; border-radius: 8px;
      font-weight: 600; cursor: pointer; transition: 0.2s; width: 100%; margin-top: 15px;
    }
    .btn:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(185, 28, 28, 0.3); }
    .btn-outline { background: white; border: 1px solid var(--red-primary); color: var(--red-primary); }
    .btn-outline:hover { background: #fef2f2; }

    /* --- H√ìA ƒê∆†N VU√îNG (TR·ªåNG T√ÇM) --- */
    #invoice-container {
      display: none; /* ·∫®n l√∫c ƒë·∫ßu */
      margin-top: 20px;
    }

    #invoice {
      width: 600px;
      height: 600px; /* H√¨nh vu√¥ng tuy·ªát ƒë·ªëi */
      background: linear-gradient(135deg, #8B0000 0%, #D20F22 100%);
      position: relative;
      padding: 20px;
      box-sizing: border-box;
      color: var(--cream);
      overflow: hidden;
      box-shadow: 0 20px 50px rgba(0,0,0,0.3);
    }

    /* Hoa vƒÉn n·ªÅn ch√¨m */
    #invoice::before {
      content: "";
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background-image: radial-gradient(#FFD700 1px, transparent 1px);
      background-size: 30px 30px;
      opacity: 0.1;
      z-index: 0;
    }

    /* Khung vi·ªÅn v√†ng trang tr√≠ */
    .border-frame {
      width: 100%; height: 100%;
      border: 3px double var(--gold);
      border-radius: 12px;
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 15px;
      box-sizing: border-box;
      background: rgba(0,0,0,0.1); /* L√†m t·ªëi nh·∫π n·ªÅn ƒë·ªÉ n·ªïi ch·ªØ */
    }

    /* 4 G√≥c trang tr√≠ */
    .corner {
      position: absolute; width: 40px; height: 40px;
      border: 3px solid var(--gold);
      border-radius: 50%; /* Tr√≤n ·ªü g√≥c */
    }
    .tl { top: -15px; left: -15px; border-right: none; border-bottom: none; }
    .tr { top: -15px; right: -15px; border-left: none; border-bottom: none; }
    .bl { bottom: -15px; left: -15px; border-right: none; border-top: none; }
    .br { bottom: -15px; right: -15px; border-left: none; border-top: none; }

    /* N·ªôi dung b√™n trong */
    .header { text-align: center; margin-top: 10px; }
    .brand { 
      font-family: 'Playfair Display', serif; 
      font-size: 28px; font-weight: 900; 
      color: var(--gold); text-shadow: 0 2px 4px rgba(0,0,0,0.3);
      letter-spacing: 2px;
    }
    .sub-brand { font-size: 10px; text-transform: uppercase; letter-spacing: 3px; opacity: 0.8; }

    .title-invoice {
      text-align: center;
      font-family: 'Dancing Script', cursive;
      font-size: 42px;
      color: var(--gold);
      margin: 10px 0;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
    }

    .main-content {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 10px;
      padding: 15px;
      margin: 0 10px;
      color: #333;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    .info-col { flex: 1; padding-right: 10px; font-size: 13px; }
    .info-line { 
      margin-bottom: 8px; border-bottom: 1px dashed #ddd; 
      padding-bottom: 2px; display: flex; justify-content: space-between;
    }
    .info-label { font-weight: 600; color: #666; }
    .info-val { font-weight: bold; color: #000; text-align: right; }

    .qr-col { 
      width: 140px; text-align: center; 
      border-left: 2px dashed var(--red-primary); padding-left: 10px;
    }
    .qr-img { width: 120px; height: 120px; object-fit: contain; }
    .qr-note { font-size: 10px; color: var(--red-primary); font-weight: bold; margin-top: 5px; }

    .total-section {
      text-align: center;
      margin: 10px 0;
    }
    .total-label { color: var(--cream); font-size: 14px; opacity: 0.9; }
    .total-amount { 
      font-size: 40px; font-weight: 800; color: var(--gold);
      font-family: 'Be Vietnam Pro', sans-serif;
      text-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }

    .footer {
      text-align: center;
      font-size: 12px;
      color: var(--cream);
      opacity: 0.8;
      border-top: 1px solid rgba(255,255,255,0.2);
      padding-top: 10px;
    }
    .horse-icon { font-size: 24px; margin-bottom: 5px; color: var(--gold); }

    /* Actions */
    .action-bar {
      margin-top: 20px;
      display: flex; gap: 10px;
    }
    .action-bar button { width: auto; flex: 1; }

    /* History */
    .history-section { width: 100%; max-width: 800px; margin-top: 2rem; }
    .history-table { width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; }
    .history-table th { background: var(--red-primary); color: white; padding: 12px; font-size: 0.9rem; text-align: left; }
    .history-table td { padding: 10px; border-bottom: 1px solid #eee; font-size: 0.9rem; }
  </style>
</head>
<body>

  <div class="input-panel">
    <h2><i class="fas fa-edit"></i> Th√¥ng Tin H√≥a ƒê∆°n</h2>
    <div class="form-grid">
      <div>
        <label>Email kh√°ch h√†ng</label>
        <input type="email" id="email" placeholder="khachhang@gmail.com">
      </div>
      <div>
        <label>S·ªë ƒëi·ªán tho·∫°i</label>
        <input type="text" id="phone" placeholder="0912...">
      </div>
    </div>
    <div class="form-grid" style="margin-top: 10px;">
      <div>
        <label>T√™n kh√≥a h·ªçc / S·∫£n ph·∫©m</label>
        <input type="text" id="course" placeholder="Combo Kh√≥a H·ªçc 2K8">
      </div>
      <div>
        <label>Gi√° ti·ªÅn (VNƒê)</label>
        <input type="number" id="price" placeholder="199000">
      </div>
    </div>
    <div class="form-grid" style="margin-top: 10px;">
      <div>
        <label>Ch·ªß t√†i kho·∫£n (ng∆∞·ªùi nh·∫≠n)</label>
        <input type="text" id="account" placeholder="NGUYEN VAN A">
      </div>
      <div>
        <label>Ng√†y thanh to√°n</label>
        <input type="date" id="date">
      </div>
    </div>
    <div style="margin-top: 10px;">
      <label>·∫¢nh QR Code (B·∫Øt bu·ªôc)</label>
      <input type="file" id="qr" accept="image/*">
    </div>
    <button class="btn" onclick="createInvoice()">
      <i class="fas fa-wand-magic-sparkles"></i> T·∫†O H√ìA ƒê∆†N VU√îNG
    </button>
  </div>

  <div id="invoice-container">
    <div id="invoice">
      <div class="border-frame">
        <div class="corner tl"></div><div class="corner tr"></div>
        <div class="corner bl"></div><div class="corner br"></div>

        <div class="header">
          <div class="brand">KHOAHOCVIP.IO.VN</div>
          <div class="sub-brand">PREMIUM EDUCATION</div>
          <div class="title-invoice">H√≥a ƒê∆°n Thanh To√°n</div>
        </div>

        <div class="main-content">
          <div class="info-col">
            <div class="info-line"><span class="info-label">M√£ GD:</span> <span class="info-val" id="outCode">#TET2026</span></div>
            <div class="info-line"><span class="info-label">Gmail:</span> <span class="info-val" id="outEmail">...</span></div>
            <div class="info-line"><span class="info-label">SƒêT:</span> <span class="info-val" id="outPhone">...</span></div>
            <div class="info-line"><span class="info-label">T√™n Kh√≥a:</span> <span class="info-val" id="outCourse">...</span></div>
            <div class="info-line"><span class="info-label">Ng√†y:</span> <span class="info-val" id="outDate">...</span></div>
            <div class="info-line"><span class="info-label">Ch·ªß TK:</span> <span class="info-val" id="outAccount" style="color:#b91c1c">...</span></div>
          </div>
          <div class="qr-col">
            <img id="outQR" class="qr-img" src="" alt="QR">
            <div class="qr-note">M√É QR THANH TO√ÅN</div>
          </div>
        </div>

        <div class="total-section">
          <div class="total-label">T·ªîNG C·ªòNG</div>
          <div class="total-amount"><span id="outPrice">0</span> <small style="font-size:20px">‚Ç´</small></div>
        </div>

        <div class="footer">
          <i class="fas fa-horse-head horse-icon"></i><br>
          C·∫£m ∆°n b·∫°n ƒë√£ tin t∆∞·ªüng KHOAHOCVIP<br>
          Ch√∫c m·ª´ng nƒÉm m·ªõi Xu√¢n B√≠nh Ng·ªç 2026 - V·∫°n s·ª± nh∆∞ √Ω
        </div>
      </div>
    </div>

    <div class="action-bar">
      <button class="btn" onclick="downloadImage()"><i class="fas fa-download"></i> T·∫£i ·∫¢nh (PNG)</button>
      <button class="btn btn-outline" onclick="downloadPDF()"><i class="fas fa-file-pdf"></i> T·∫£i PDF</button>
    </div>
  </div>

  <div class="history-section">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
        <h3><i class="fas fa-clock"></i> L·ªãch s·ª≠ t·∫°o</h3>
        <button class="btn" style="width:auto; margin:0; padding:8px 15px; font-size:0.8rem;" onclick="exportExcel()">Xu·∫•t Excel</button>
    </div>
    <table class="history-table" id="historyTable">
      <thead>
        <tr>
          <th>M√£</th>
          <th>Email</th>
          <th>Kh√≥a h·ªçc</th>
          <th>Gi√° tr·ªã</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

<script>
  // Set default date
  document.getElementById('date').valueAsDate = new Date();
  
  const historyData = JSON.parse(localStorage.getItem("invHistory") || "[]");

  function createInvoice() {
    // Get values
    const email = document.getElementById('email').value;
    const phone = document.getElementById('phone').value;
    const course = document.getElementById('course').value;
    const price = document.getElementById('price').value;
    const date = document.getElementById('date').value;
    const account = document.getElementById('account').value;
    const qrInput = document.getElementById('qr');

    if(!qrInput.files[0]) return alert("B·∫°n ch∆∞a ch·ªçn ·∫£nh QR!");

    const reader = new FileReader();
    reader.onload = function(e) {
      const code = "GD" + Math.floor(100000 + Math.random() * 900000);
      
      // Fill Data
      document.getElementById('outCode').innerText = code;
      document.getElementById('outEmail').innerText = email;
      document.getElementById('outPhone').innerText = phone;
      document.getElementById('outCourse').innerText = course;
      document.getElementById('outDate').innerText = date.split('-').reverse().join('/');
      document.getElementById('outAccount').innerText = account.toUpperCase();
      document.getElementById('outPrice').innerText = parseInt(price).toLocaleString('vi-VN');
      document.getElementById('outQR').src = e.target.result;

      // Show Invoice
      document.getElementById('invoice-container').style.display = 'block';
      document.getElementById('invoice-container').scrollIntoView({ behavior: 'smooth' });

      // Save History
      const record = { code, email, phone, course, price, date };
      historyData.push(record);
      localStorage.setItem("invHistory", JSON.stringify(historyData));
      renderHistory();
    };
    reader.readAsDataURL(qrInput.files[0]);
  }

  function renderHistory() {
    const tbody = document.querySelector("#historyTable tbody");
    tbody.innerHTML = "";
    [...historyData].reverse().slice(0, 10).forEach(item => { // Show last 10
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td style="font-weight:bold; color:#b91c1c">${item.code}</td>
        <td>${item.email}</td>
        <td>${item.course}</td>
        <td>${parseInt(item.price).toLocaleString()} ƒë</td>
      `;
      tbody.appendChild(tr);
    });
  }

  function downloadImage() {
    const node = document.getElementById('invoice');
    html2canvas(node, { scale: 2 }).then(canvas => {
      const link = document.createElement('a');
      link.download = `HoaDonVuong-${Date.now()}.png`;
      link.href = canvas.toDataURL("image/png");
      link.click();
    });
  }

  function downloadPDF() {
    const element = document.getElementById('invoice');
    // V·ªõi h√≥a ƒë∆°n vu√¥ng, ta set kh·ªï gi·∫•y custom
    const opt = {
      margin: 0,
      filename: `HoaDon-${Date.now()}.pdf`,
      image: { type: 'jpeg', quality: 1 },
      html2canvas: { scale: 2 },
      jsPDF: { unit: 'px', format: [600, 600], orientation: 'portrait' } 
    };
    html2pdf().set(opt).from(element).save();
  }

  function exportExcel() {
    const ws = XLSX.utils.json_to_sheet(historyData);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "DanhSach");
    XLSX.writeFile(wb, "History_HoaDon.xlsx");
  }

  // Init
  renderHistory();
</script>

</body>
</html>

<!-- <!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>H√≥a ƒë∆°n thanh to√°n</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    body {
      background: #f3f6fb;
      font-family: 'Inter', sans-serif;
      padding: 2rem;
    }
    .invoice-form, .invoice-preview, .history-section {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.1);
      margin-bottom: 2rem;
    }
    h2 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 1rem;
    }
    input, label {
      display: block;
      width: 100%;
    }
    input {
      padding: 0.75rem;
      margin-bottom: 1rem;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    label {
      font-weight: bold;
      margin: 0.5rem 0 0.25rem;
    }
    .btn {
      background-color: #2b6cb0;
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      border-radius: 8px;
      cursor: pointer;
      margin-right: 1rem;
    }
    .btn:hover {
      background-color: #1a4f80;
    }
    #invoice {
      max-width: 700px;
      margin: auto;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      padding: 2rem;
    }
    .invoice-header {
      text-align: center;
      margin-bottom: 1rem;
    }
    .invoice-header img {
      max-height: 60px;
      margin-bottom: 10px;
    }
    .invoice-header h3 {
      margin-bottom: 0.2rem;
      color: #2c3e50;
      font-size: 1.5rem;
    }
    .invoice-id {
      text-align: right;
      font-weight: bold;
      margin-bottom: 1rem;
      color: #4a5568;
    }
    .invoice-info p {
      font-size: 1rem;
      margin: 6px 0;
    }
    .qr-section {
      text-align: center;
    }
    .qr-section img {
      width: 180px;
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 6px;
      background: #f9f9f9;
    }
    .button-group {
      text-align: center;
      margin-top: 1.5rem;
    }
    .history-section table {
      width: 100%;
      border-collapse: collapse;
    }
    .history-section th, .history-section td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: left;
    }
    .history-section th {
      background-color: #f0f0f0;
    }
  </style>
</head>
<body>

<script>
  const PASSWORD = "lamlam2802";
  const input = prompt("üîê Nh·∫≠p m·∫≠t kh·∫©u ƒë·ªÉ truy c·∫≠p t·∫°o h√≥a ƒë∆°n:");
  if (input !== PASSWORD) {
    alert("‚ùå Sai m·∫≠t kh·∫©u.");
    window.location.href = "/";
  }
</script> -->

<!-- <main>
  <h2><i class="fas fa-file-invoice-dollar"></i> T·∫°o h√≥a ƒë∆°n thanh to√°n</h2>

  <div class="invoice-form">
    <label>Email:</label>
    <input type="email" id="email">
    <label>S·ªë ƒëi·ªán tho·∫°i:</label>
    <input type="text" id="phone">
    <label>T√™n kh√≥a h·ªçc:</label>
    <input type="text" id="course">
    <label>Gi√° (VND):</label>
    <input type="number" id="price">
    <label>Ng√†y thanh to√°n:</label>
    <input type="date" id="date">
    <label>·∫¢nh QR chuy·ªÉn kho·∫£n:</label>
    <input type="file" id="qr" accept="image/*">
    <label>T√™n ch·ªß t√†i kho·∫£n:</label>
    <input type="text" id="account">
    <button class="btn" onclick="generateInvoice()"><i class="fas fa-eye"></i> T·∫°o h√≥a ƒë∆°n</button>
  </div>

  <div class="invoice-preview" style="display:none">
    <div id="invoice">
      <div class="invoice-header">
        <div style="font-size: 24px; font-weight: bold; color: #2c3e50; margin-bottom: 10px;">khoahocvip.io.vn</div>
        <h3><i class="fas fa-receipt"></i> H√ìA ƒê∆†N THANH TO√ÅN</h3>
      </div>
      <div class="invoice-id">
        M√£ h√≥a ƒë∆°n: <span id="invoiceCode"></span>
      </div>
      <div class="invoice-info">
        <p><strong>Email:</strong> <span id="outEmail"></span></p>
        <p><strong>SƒêT:</strong> <span id="outPhone"></span></p>
        <p><strong>Kh√≥a h·ªçc:</strong> <span id="outCourse"></span></p>
        <p><strong>Gi√°:</strong> <span id="outPrice"></span> VND</p>
        <p><strong>Ng√†y thanh to√°n:</strong> <span id="outDate"></span></p>
      </div>
      <div class="qr-section">
        <img id="outQR" alt="QR ng√¢n h√†ng">
        <p id="outAccount"></p>
      </div>
    </div>
    <div class="button-group">
      <button class="btn" onclick="downloadPDF()"><i class="fas fa-file-pdf"></i> T·∫£i PDF</button>
      <button class="btn" onclick="downloadImage()"><i class="fas fa-image"></i> T·∫£i ·∫£nh</button>
    </div>
  </div>

  <div class="history-section">
    <h2>L·ªãch s·ª≠ h√≥a ƒë∆°n ƒë√£ t·∫°o</h2>
    <table id="historyTable">
      <thead>
        <tr>
          <th>M√£</th><th>Email</th><th>SƒêT</th><th>Kh√≥a h·ªçc</th><th>Gi√°</th><th>Ng√†y</th><th>Ch·ªß TK</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <div class="button-group">
      <button class="btn" onclick="exportToExcel()"><i class="fas fa-file-excel"></i> T·∫£i danh s√°ch Excel</button>
    </div>
  </div>
</main>

<script>
  const historyData = JSON.parse(localStorage.getItem("invoiceHistory") || "[]");

  function generateInvoice() {
    const email = document.getElementById('email').value;
    const phone = document.getElementById('phone').value;
    const course = document.getElementById('course').value;
    const price = document.getElementById('price').value;
    const date = document.getElementById('date').value;
    const account = document.getElementById('account').value;
    const qrInput = document.getElementById('qr');

    if (!qrInput.files[0]) return alert("Ch·ªçn ·∫£nh QR");

    const reader = new FileReader();
    reader.onload = function(e) {
      const code = Math.floor(100000 + Math.random() * 900000);
      document.getElementById('outEmail').textContent = email;
      document.getElementById('outPhone').textContent = phone;
      document.getElementById('outCourse').textContent = course;
      document.getElementById('outPrice').textContent = parseInt(price).toLocaleString();
      document.getElementById('outDate').textContent = date.split('-').reverse().join('/');
      document.getElementById('outQR').src = e.target.result;
      document.getElementById('outAccount').textContent = "Ch·ªß t√†i kho·∫£n: " + account;
      document.getElementById('invoiceCode').textContent = code;
      document.querySelector('.invoice-preview').style.display = 'block';

      // L∆∞u l·ªãch s·ª≠
      const invoice = { code, email, phone, course, price, date, account };
      historyData.push(invoice);
      localStorage.setItem("invoiceHistory", JSON.stringify(historyData));
      renderHistory();
    };
    reader.readAsDataURL(qrInput.files[0]);
  }

  function renderHistory() {
    const tbody = document.querySelector("#historyTable tbody");
    tbody.innerHTML = "";
    historyData.forEach(item => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${item.code}</td>
        <td>${item.email}</td>
        <td>${item.phone}</td>
        <td>${item.course}</td>
        <td>${parseInt(item.price).toLocaleString()}</td>
        <td>${item.date.split('-').reverse().join('/')}</td>
        <td>${item.account}</td>
      `;
      tbody.appendChild(tr);
    });
  }

  function downloadPDF() {
    html2pdf().from(document.getElementById('invoice')).set({
      margin: 0.5,
      filename: `hoa-don-${Date.now()}.pdf`,
      image: { type: 'jpeg', quality: 0.98 },
      html2canvas: { scale: 2 },
      jsPDF: { unit: 'cm', format: 'a4', orientation: 'portrait' }
    }).save();
  }

  function downloadImage() {
    html2canvas(document.getElementById('invoice')).then(canvas => {
      const link = document.createElement('a');
      link.download = `hoa-don-${Date.now()}.png`;
      link.href = canvas.toDataURL();
      link.click();
    });
  }

  function exportToExcel() {
    const ws = XLSX.utils.json_to_sheet(historyData);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Invoices");
    XLSX.writeFile(wb, "danh-sach-hoa-don.xlsx");
  }

  renderHistory();
</script>

</body>
</html> -->
